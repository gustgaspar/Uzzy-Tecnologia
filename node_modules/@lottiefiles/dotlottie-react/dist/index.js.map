{"version":3,"file":"index.js","names":[],"sources":["../src/base-dotlottie-react.tsx","../src/dotlottie.tsx","../src/dotlottie-worker.tsx","../src/index.ts"],"sourcesContent":["/* eslint-disable no-warning-comments */\n'use client';\n\nimport type { Config, DotLottie, DotLottieWorker } from '@lottiefiles/dotlottie-web';\nimport { type ComponentProps, type JSX, type RefCallback, useCallback, useEffect, useRef } from 'react';\n\nexport type BaseDotLottieProps<T extends DotLottie | DotLottieWorker> = Omit<Config, 'canvas'> &\n  ComponentProps<'canvas'> & {\n    animationId?: string;\n    /**\n     * A function that creates a `DotLottie` or `DotLottieWorker` instance.\n     */\n    createDotLottie: (config: T extends DotLottieWorker ? Config & { workerId?: string } : Config) => T;\n    /**\n     * A callback function that receives the `DotLottie` or `DotLottieWorker` instance.\n     *\n     * @example\n     * ```tsx\n     * const [dotLottie, setDotLottie] = useState<DotLottie | null>(null);\n     *\n     * <DotLottieReact\n     *   dotLottieRefCallback={setDotLottie}\n     * />\n     * ```\n     */\n    dotLottieRefCallback?: RefCallback<T | null>;\n    /**\n     * @deprecated The `playOnHover` property is deprecated.\n     * Instead, use the `onMouseEnter` and `onMouseLeave` events to control animation playback.\n     * Utilize the `dotLottieRefCallback` to access the `DotLottie` instance and invoke the `play` and `pause` methods.\n     *\n     * Example usage:\n     * ```tsx\n     * const [dotLottie, setDotLottie] = useState<DotLottie | null>(null);\n     *\n     * <DotLottieReact\n     *   dotLottieRefCallback={setDotLottie}\n     *   onMouseEnter={() => dotLottie?.play()}\n     *   onMouseLeave={() => dotLottie?.pause()}\n     * />\n     * ```\n     */\n    playOnHover?: boolean;\n    themeData?: string;\n    workerId?: T extends DotLottieWorker ? string : undefined;\n  };\n\nexport const BaseDotLottieReact = <T extends DotLottie | DotLottieWorker>({\n  animationId,\n  autoplay,\n  backgroundColor,\n  className,\n  createDotLottie,\n  data,\n  dotLottieRefCallback,\n  layout,\n  loop,\n  mode,\n  playOnHover,\n  renderConfig,\n  segment,\n  speed,\n  src,\n  stateMachineConfig,\n  stateMachineId,\n  style,\n  themeData,\n  themeId,\n  useFrameInterpolation,\n  workerId,\n  ...props\n}: BaseDotLottieProps<T> & {\n  createDotLottie: (config: T extends DotLottieWorker ? Config & { workerId?: string } : Config) => T;\n}): JSX.Element => {\n  const dotLottieRef = useRef<T | null>(null);\n  const canvasRef = useRef<HTMLCanvasElement | null>(null);\n  const dotLottieRefCallbackRef = useRef<RefCallback<T | null> | undefined>(dotLottieRefCallback);\n\n  const config: Omit<Config, 'canvas'> & {\n    workerId?: T extends DotLottieWorker ? string : undefined;\n  } = {\n    speed,\n    mode,\n    loop,\n    useFrameInterpolation,\n    segment,\n    backgroundColor,\n    autoplay,\n    themeId,\n    workerId,\n    src,\n    data,\n    layout,\n    renderConfig,\n    animationId,\n    stateMachineConfig,\n    stateMachineId,\n  };\n\n  const configRef = useRef<Omit<BaseDotLottieProps<T>, 'createDotLottie' | 'dotLottieRefCallback'> | undefined>(config);\n\n  dotLottieRefCallbackRef.current = dotLottieRefCallback;\n  configRef.current = config;\n\n  // biome-ignore lint/correctness/useExhaustiveDependencies: DotLottie instance must only be created once per canvas mount\n  const setCanvasRef = useCallback((canvas: HTMLCanvasElement | null) => {\n    canvasRef.current = canvas;\n\n    if (canvas) {\n      dotLottieRef.current = createDotLottie({\n        ...configRef.current,\n        canvas,\n      });\n    } else {\n      dotLottieRef.current?.destroy();\n      dotLottieRef.current = null;\n    }\n\n    dotLottieRefCallbackRef.current?.(dotLottieRef.current);\n  }, []);\n\n  useEffect(() => {\n    const handlePlayOnHover = (event: MouseEvent): void => {\n      if (!playOnHover) return;\n\n      if (event.type === 'mouseenter') {\n        dotLottieRef.current?.play();\n      }\n\n      if (event.type === 'mouseleave') {\n        dotLottieRef.current?.pause();\n      }\n    };\n\n    canvasRef.current?.addEventListener('mouseenter', handlePlayOnHover);\n    canvasRef.current?.addEventListener('mouseleave', handlePlayOnHover);\n\n    return () => {\n      canvasRef.current?.removeEventListener('mouseenter', handlePlayOnHover);\n      canvasRef.current?.removeEventListener('mouseleave', handlePlayOnHover);\n    };\n  }, [playOnHover]);\n\n  useEffect(() => {\n    dotLottieRef.current?.setSpeed(speed ?? 1);\n  }, [speed]);\n\n  useEffect(() => {\n    dotLottieRef.current?.setMode(mode ?? 'forward');\n  }, [mode]);\n\n  useEffect(() => {\n    dotLottieRef.current?.setLoop(loop ?? false);\n  }, [loop]);\n\n  useEffect(() => {\n    dotLottieRef.current?.setUseFrameInterpolation(useFrameInterpolation ?? true);\n  }, [useFrameInterpolation]);\n\n  useEffect(() => {\n    if (typeof segment?.[0] === 'number' && typeof segment[1] === 'number') {\n      dotLottieRef.current?.setSegment(segment[0], segment[1]);\n    } else {\n      // TODO: implement it for worker\n      // dotLottieRef.current?.resetSegment();\n    }\n  }, [segment]);\n\n  useEffect(() => {\n    dotLottieRef.current?.setBackgroundColor(backgroundColor ?? '');\n  }, [backgroundColor]);\n\n  // biome-ignore lint/correctness/useExhaustiveDependencies: intentional deep comparison via JSON.stringify\n  useEffect(() => {\n    dotLottieRef.current?.setRenderConfig(renderConfig ?? {});\n  }, [JSON.stringify(renderConfig)]);\n\n  useEffect(() => {\n    if (typeof data !== 'string' && typeof data !== 'object') return;\n\n    dotLottieRef.current?.load({\n      data,\n      ...configRef.current,\n    });\n  }, [data]);\n\n  useEffect(() => {\n    if (typeof src !== 'string') return;\n\n    dotLottieRef.current?.load({\n      src,\n      ...configRef.current,\n    });\n  }, [src]);\n\n  useEffect(() => {\n    dotLottieRef.current?.setMarker(props.marker ?? '');\n  }, [props.marker]);\n\n  useEffect(() => {\n    dotLottieRef.current?.loadAnimation(animationId ?? '');\n  }, [animationId]);\n\n  useEffect(() => {\n    if (typeof themeId === 'string') {\n      dotLottieRef.current?.setTheme(themeId);\n    } else {\n      // TODO: implement it for worker\n      // dotLottieRef.current?.resetTheme();\n    }\n  }, [themeId]);\n\n  useEffect(() => {\n    dotLottieRef.current?.setThemeData(themeData ?? '');\n  }, [themeData]);\n\n  // biome-ignore lint/correctness/useExhaustiveDependencies: granular property deps avoid unnecessary setLayout calls when layout object reference changes\n  useEffect(() => {\n    dotLottieRef.current?.setLayout(layout ?? {});\n  }, [layout?.fit, layout?.align?.[0], layout?.align?.[1]]);\n\n  useEffect(() => {\n    if (dotLottieRef.current?.isLoaded) {\n      if (typeof stateMachineId === 'string' && stateMachineId) {\n        const smLoaded = dotLottieRef.current.stateMachineLoad(stateMachineId);\n\n        if (smLoaded) {\n          dotLottieRef.current.stateMachineStart();\n        }\n      } else {\n        dotLottieRef.current.stateMachineStop();\n      }\n    }\n  }, [stateMachineId]);\n\n  useEffect(() => {\n    dotLottieRef.current?.stateMachineSetConfig(stateMachineConfig ?? null);\n  }, [stateMachineConfig]);\n\n  return (\n    <div\n      className={className}\n      {...(!className && {\n        style: {\n          width: '100%',\n          height: '100%',\n          lineHeight: 0,\n          ...style,\n        },\n      })}\n    >\n      <canvas\n        ref={setCanvasRef}\n        style={{\n          width: '100%',\n          height: '100%',\n        }}\n        {...props}\n      />\n    </div>\n  );\n};\n","'use client';\n\nimport type { Config } from '@lottiefiles/dotlottie-web';\nimport { DotLottie } from '@lottiefiles/dotlottie-web';\nimport type { JSX } from 'react';\n\nimport type { BaseDotLottieProps } from './base-dotlottie-react';\nimport { BaseDotLottieReact } from './base-dotlottie-react';\n\nexport type DotLottieReactProps = Omit<BaseDotLottieProps<DotLottie>, 'createDotLottie'>;\n\nconst createDotLottie = (config: Config): DotLottie => new DotLottie(config);\n\nexport const DotLottieReact = (props: DotLottieReactProps): JSX.Element => {\n  return <BaseDotLottieReact {...props} createDotLottie={createDotLottie} />;\n};\n","'use client';\n\nimport type { Config } from '@lottiefiles/dotlottie-web';\nimport { DotLottieWorker } from '@lottiefiles/dotlottie-web';\nimport type { JSX } from 'react';\nimport type { BaseDotLottieProps } from './base-dotlottie-react';\nimport { BaseDotLottieReact } from './base-dotlottie-react';\n\nexport type DotLottieWorkerReactProps = Omit<BaseDotLottieProps<DotLottieWorker>, 'createDotLottie'>;\n\nconst createDotLottieWorker = (config: Config & { workerId?: string }): DotLottieWorker => new DotLottieWorker(config);\n\nexport const DotLottieWorkerReact = (props: DotLottieWorkerReactProps): JSX.Element => {\n  return <BaseDotLottieReact {...props} createDotLottie={createDotLottieWorker} />;\n};\n","'use client';\n\nimport { DotLottie, DotLottieWorker } from '@lottiefiles/dotlottie-web';\n\nexport type * from '@lottiefiles/dotlottie-web';\nexport * from './dotlottie';\nexport * from './dotlottie-worker';\n\nexport const setWasmUrl = (url: string): void => {\n  DotLottieWorker.setWasmUrl(url);\n  DotLottie.setWasmUrl(url);\n};\n"],"mappings":"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"}